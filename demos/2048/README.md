# Tutorial for building and running 2048 WASM demo with Webinizer

The `2048` project requires the `ncurses` library to run. To successfully build the `2048` project,
we'd build the `ncurses` library at first, and then build `2048` to utilize the library.

For the tutorial for building the `ncurses` library, please refer to the
[README](../ncurses/README.md) file for details.

## How to build 2048 with Webinizer

1. **`Main page`** - Click `Get Started` in Webinizer main page to enter the project list page.

2. **`Get started page`** - Click the `SELECT` button of the 2048 project to enter the
   `Basic config` page.

3. **`Basic config page`** - Click `BUILD STEPS ->` in the lower right corner or `Steps` in the top
   navigation panel to enter the `Build steps` page.

4. **`Build steps page`**

   - Select the `static` build target and Webinizer will prompt you with the recommended build steps
     for the project.

   - Click `YES` to accept the recommendation.

   - Click `Config` in the top navigation panel to enter the `Configuration` page.

5. **`Configuration page`**

   - Disable `Infinite main loop` and `Modularize JS output` options.

     > Note. _As we are building the demo to run in a worker thread, so the main thread blocking
     > issue from infinite main loop doesn’t exist and we can leave the JavaScript glue code to run
     > in a global scope in the worker thread._

   - Click `Build` in the top navigation panel to enter the `Build` page.

6. **`Build page`**

   - Click the `BUILD` button and a recipe will show up: `Recipe for issue of missing header file`.

     > Note. _As 2048 depends on the ncurses library, we should ensure ncurses is successfully built
     > by Webinizer at first and add it from the dependencies list afterwards._

   - Click `Basic` in the top navigation panel to enter the `Basic config` page.

7. **`Basic config page`**

   - Click `PROJECT DEPENDENCIES >` to show the `Dependencies` section.

   - Click `ADD DEPENDENCIES`, choose `Ncurses` from the list and click `FINISH` to save the
     changes.

     > Note. _The adding dependencies process might take a while, depending on the library size.
     > Please wait until it finishes to proceed._

   - Click `Build` in the top navigation panel to enter the `Build` page.

8. **`Build page`**

   - Click the `BUILD` button and a recipe will show up: `Recipes generated for dependent projects`.

   - Expand the recipe, follow the suggestion and click the `GOTO` link to navigate to a new tab for
     the dependent project ncurses' `Build` page.

9. **`Build page` for `ncurses`**

   - Click the `IGNORE` button to dismiss the `recipe on C++ exception issue` generated by Webinizer
     for the Ncurses project.

     > Note. _As the usage of C++ exception is detected from demos, which are not related to the
     > core library, we can ignore the recipe._

   - Switch back to the `Build page` for `2048`.

10. **`Build page` for `2048`** - Click the `BUILD` button to trigger the build again.

After a while, it will show `Build successfully!` on the page.

## How to run 2048 demo in the browser

- Below are the generated files that are required to run the demo. By default they are under the
  `_build` folder of the project root.

  - 2048-in-terminal.js
  - 2048-in-terminal.wasm
  - 2048-in-terminal.data

- Under this demo folder we have some other files prepared for running 2048 in the browser.

  - `index.html`: demo page
  - `2048.worker.js`: worker script to load and run wasm module

- Set up the server

  Run the script to copy all the files required and start the server.

  ```sh
  ./run.sh
  ```

- Run in the browser

  Launch the browser with `SharedArrayBuffer` enabled at first:

  ```bash
  path/to/your/chrome --enable-features=SharedArrayBuffer
  ```

  Then visit:

  ```
  http://localhost:8080
  ```

- Try it!

  - Directions – W(Up), S(Down), A(Left), D(Right)
